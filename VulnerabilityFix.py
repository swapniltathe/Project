# Vulnerability - World writable files perm revoke for Unix
import os
# check if file exists
    # if exists then note down permissions
        # change permissions
        # print permissions changed for file
# if file don't exists
    # print file not found
try:
    check_files = open("ww_files", "r")
    print("File Name,Status,Before,After")
    for file in check_files.readlines():
        file = file.strip()
        if os.path.isfile(file):
            # print(file + ", found")
            old_out = os.popen("ls -ltr "+file).read().strip()
            # print(old_out)
            os.system("chmod"+" o-w "+file)
            new_out = os.popen("ls -ltr "+file).read().strip()
            # print(type(new_out))
            print(file+",Exists,"+old_out+","+new_out)
        else:
            print(file + ",Not found")

except Exception as e:
    print("Error: ", e)

finally:
    check_files.close()
